<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title class="pjax-title">
        Pod一直显示Terminating
        
    </title><meta name="Description" content="Coding, Reading and Daydreaming"><meta property="og:title" content="Pod一直显示Terminating" />
<meta property="og:description" content="问题集群中有一个pod一直显示Terminating eventNormal Scheduled 1h default-scheduler Successfully assigned feed-426565da19777e5d325f-5994dc5cff-znqmh to node01 Normal SuccessfulMountVolume 1h kubelet, node01 (combined from similar events): MountVolume.SetUp succeeded for volume &#34;lvm&#34; Normal Pulled 1h kubelet, node01 Container image already present on machine Normal Created 1h kubelet, node01 Created container Normal Started 1h kubelet, node01 Started container Warning Unhealthy 9m (x44 over 1h) kubelet, node01 Liveness probe failed: Get http://*:65318/state.json: dial tcp *.*.*.*:65318: getsockopt: connection refused Warning Unhealthy 9m (x45 over 1h) kubelet," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://qingwave.github.io/pod-terminating-long-time/" /><meta property="og:image" content="https://qingwave.github.io/img/favicon.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-26T10:41:03+00:00" />
<meta property="article:modified_time" content="2021-11-20T10:59:07+00:00" /><meta property="og:site_name" content="Qingwave" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://qingwave.github.io/img/favicon.png"/>

<meta name="twitter:title" content="Pod一直显示Terminating"/>
<meta name="twitter:description" content="问题集群中有一个pod一直显示Terminating eventNormal Scheduled 1h default-scheduler Successfully assigned feed-426565da19777e5d325f-5994dc5cff-znqmh to node01 Normal SuccessfulMountVolume 1h kubelet, node01 (combined from similar events): MountVolume.SetUp succeeded for volume &#34;lvm&#34; Normal Pulled 1h kubelet, node01 Container image already present on machine Normal Created 1h kubelet, node01 Created container Normal Started 1h kubelet, node01 Started container Warning Unhealthy 9m (x44 over 1h) kubelet, node01 Liveness probe failed: Get http://*:65318/state.json: dial tcp *.*.*.*:65318: getsockopt: connection refused Warning Unhealthy 9m (x45 over 1h) kubelet,"/>
<meta name="application-name" content="Qingwave">
<meta name="apple-mobile-web-app-title" content="Qingwave">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://qingwave.github.io/pod-terminating-long-time/" /><link rel="prev" href="https://qingwave.github.io/pod-timezone/" /><link rel="next" href="https://qingwave.github.io/pod-memory-usage-in-k8s/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"></noscript><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><meta name="google-site-verification" content="-8bOgP-V4XsxXZtXVx9DIXkdIuruvAYiY37vBg26acI" /><meta name="baidu-site-verification" content="muFp3xopwC" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Pod一直显示Terminating",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/qingwave.github.io\/pod-terminating-long-time\/"
        },"genre": "posts","keywords": "k8s","wordcount":  358 ,
        "url": "https:\/\/qingwave.github.io\/pod-terminating-long-time\/","datePublished": "2018-10-26T10:41:03+00:00","dateModified": "2021-11-20T10:59:07+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Qingwave"
            },"description": ""
    }
    </script></head>

<body header-desktop="normal" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {document.body.setAttribute('theme', theme); document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');}
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('light' === 'light' || 'light' === 'dark') setTheme('light'), saveTheme('light'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Qingwave">Qingwave<span class="header-title-inner">'</span><span class="header-title-post"> Time</span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/about/" title="About">About</a><a class="menu-item" href="/tags/" title="Tags">Tags</a><a class="menu-item" href="/categories/" title="Categories">Categories</a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Qingwave">Qingwave<span class="header-title-inner">'</span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/about/" title="About">About</a><a class="menu-item" href="/tags/" title="Tags">Tags</a><a class="menu-item" href="/categories/" title="Categories">Categories</a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
            <div class="container"><div class="toc" id="toc-auto">
        <h2 class="toc-title">目录</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#问题">问题</a>
      <ul>
        <li><a href="#event">event</a></li>
        <li><a href="#日志">日志</a></li>
      </ul>
    </li>
    <li><a href="#探究">探究</a>
      <ul>
        <li><a href="#查看进程">查看进程</a></li>
        <li><a href="#可能原因">可能原因</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle", "normal")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single"><h1 class="single-title">Pod一直显示Terminating</h1><div class="post-meta">
            <div class="post-meta-line"><time datetime="Oct 26, 2018">Oct 26, 2018</time>
            </div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#问题">问题</a>
      <ul>
        <li><a href="#event">event</a></li>
        <li><a href="#日志">日志</a></li>
      </ul>
    </li>
    <li><a href="#探究">探究</a>
      <ul>
        <li><a href="#查看进程">查看进程</a></li>
        <li><a href="#可能原因">可能原因</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="问题" class="headerLink">
    <a href="#%e9%97%ae%e9%a2%98" class="header-mark"></a>问题</h2><p>集群中有一个pod一直显示Terminating</p>
<h3 id="event" class="headerLink">
    <a href="#event" class="header-mark"></a>event</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Normal Scheduled 1h default-scheduler Successfully assigned feed-426565da19777e5d325f-5994dc5cff-znqmh to node01
</span></span><span class="line"><span class="cl">Normal SuccessfulMountVolume 1h kubelet, node01 <span class="o">(</span>combined from similar events<span class="o">)</span>: MountVolume.SetUp succeeded <span class="k">for</span> volume <span class="s2">&#34;lvm&#34;</span>
</span></span><span class="line"><span class="cl">Normal Pulled 1h kubelet, node01 Container image  already present on machine
</span></span><span class="line"><span class="cl">Normal Created 1h kubelet, node01 Created container
</span></span><span class="line"><span class="cl">Normal Started 1h kubelet, node01 Started container
</span></span><span class="line"><span class="cl">Warning Unhealthy 9m <span class="o">(</span>x44 over 1h<span class="o">)</span> kubelet, node01 Liveness probe failed: Get http://*:65318/state.json: dial tcp *.*.*.*:65318: getsockopt: connection refused
</span></span><span class="line"><span class="cl">Warning Unhealthy 9m <span class="o">(</span>x45 over 1h<span class="o">)</span> kubelet, node01 Readiness probe failed: Get http://*:65318/state.json: dial tcp *.*.*.*:65318: getsockopt: connection refused
</span></span><span class="line"><span class="cl">Normal Killing 9m kubelet, node01 Killing container with id docker://main:Need to <span class="nb">kill</span> Pod
</span></span><span class="line"><span class="cl">Warning FailedKillPod 5m <span class="o">(</span>x2 over 7m<span class="o">)</span> kubelet, node01 error killing pod: failed to <span class="s2">&#34;KillPodSandbox&#34;</span> <span class="k">for</span> <span class="s2">&#34;163f99a9-1aec-11e9-a7cd-246e96ab9970&#34;</span> with KillPodSandboxError: <span class="s2">&#34;rpc error: code = DeadlineExceeded desc = context deadline exceeded&#34;</span>
</span></span></code></pre></div><h3 id="日志" class="headerLink">
    <a href="#%e6%97%a5%e5%bf%97" class="header-mark"></a>日志</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubelet: error killing pod: failed to <span class="s2">&#34;KillPodSandbox&#34;</span> <span class="k">for</span> <span class="s2">&#34;163f99a9-1aec-11e9-a7cd-246e96ab9970&#34;</span> with KillPodSandboxError: <span class="s2">&#34;rpc error: code = DeadlineExceeded desc = context deadline exceeded&#34;</span>
</span></span></code></pre></div><h2 id="探究" class="headerLink">
    <a href="#%e6%8e%a2%e7%a9%b6" class="header-mark"></a>探究</h2><h3 id="查看进程" class="headerLink">
    <a href="#%e6%9f%a5%e7%9c%8b%e8%bf%9b%e7%a8%8b" class="header-mark"></a>查看进程</h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ps aux <span class="p">|</span>grep D <span class="c1">#查看无法终止的进程（stat D）</span>
</span></span><span class="line"><span class="cl">root <span class="m">2626</span> 0.0 0.0 <span class="m">0</span> <span class="m">0</span> ? Ds 14:42 0:00 <span class="o">[</span>pause<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ps afx <span class="p">|</span>grep -C <span class="m">10</span> <span class="m">2626</span> <span class="c1">#显示父进程</span>
</span></span><span class="line"><span class="cl">root <span class="m">2626</span> <span class="m">2603</span> <span class="m">0</span> 14:42 ? 00:00:00 <span class="o">[</span>pause<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ps -ef <span class="p">|</span>grep <span class="m">2603</span> <span class="c1">#查看父进程</span>
</span></span><span class="line"><span class="cl">root <span class="m">2603</span> <span class="m">27573</span> <span class="m">0</span> 14:42 ? 00:00:00 docker-containerd-shim -namespace moby -workdir /home/docker/containerd/daemon/io.containerd.runtime.v1.linux/moby/ba519a9f1a1102a922bcc74ced7a7fc9fd3f963feea4b8de
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ps -ef <span class="p">|</span>grep <span class="m">27573</span>
</span></span><span class="line"><span class="cl">root <span class="m">27573</span> <span class="m">27553</span> <span class="m">0</span> <span class="m">2018</span> ? 17:02:40 docker-containerd --config /var/run/docker/containerd/containerd.toml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ps -ef <span class="p">|</span>grep <span class="m">27553</span>
</span></span><span class="line"><span class="cl">root <span class="m">27553</span> <span class="m">1</span> <span class="m">3</span> <span class="m">2018</span> ? 3-16:03:11 /usr/bin/dockerd --bip<span class="o">=</span>10.126.64.193/26 --mtu<span class="o">=</span><span class="m">1500</span> -g /home/docker -D -H tcp://127.0.0.1:1983 -H unix:///var/run/docker.sock --tlsverify --iptables<span class="o">=</span><span class="nb">false</span> --storage-driver<span class="o">=</span>devicemapper --storage-opt dm.override_udev_sync_check<span class="o">=</span><span class="nb">true</span> --storage-opt dm.datadev<span class="o">=</span>/dev/vg_root/dmdata --storage-opt dm.metadatadev<span class="o">=</span>/dev/vg_root/dmmeta --exec-opt native.cgroupdriver<span class="o">=</span>cgroupfs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker ps <span class="p">|</span>grep ba519a9f1a1 <span class="c1">#查看docker</span>
</span></span><span class="line"><span class="cl">ba519a9f1a11 k8s.gcr.io/pause-amd64:3.1 <span class="s2">&#34;/pause&#34;</span> <span class="m">2</span> hours ago Up <span class="m">2</span> hours k8s_POD_feed-426565da19777e5d325f-5994dc5cff-znqmh_ocean-feed_163f99a9-1aec-11e9-a7cd-246e96ab9970_0
</span></span></code></pre></div><h3 id="可能原因" class="headerLink">
    <a href="#%e5%8f%af%e8%83%bd%e5%8e%9f%e5%9b%a0" class="header-mark"></a>可能原因</h3><p>可能是内核原因
<a href="https://stackoverflow.com/questions/34552232/cant-kill-processes-originating-in-a-docker-container" target="_blank" rel="noopener noreffer">https://stackoverflow.com/questions/34552232/cant-kill-processes-originating-in-a-docker-container</a>
目前只有重启物理机才能解决</p>
</div>

        
        <div class="post-footer" id="post-footer">
    <div class="post-meta-line"><span class="single-tag">
                <a href='/tags/k8s/'>#k8s</a></span></div>

    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-link">
                <a href='/about'>About Me</a>
            </div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
        </div>
    </div><div class="post-nav"><a href="/pod-timezone/" class="prev" rel="prev" title="Pod中时区设置"><i class="fas fa-angle-left fa-fw"></i>Pod中时区设置</a>
            <a href="/pod-memory-usage-in-k8s/" class="next" rel="next" title="Pod memory usage in k8s">Pod memory usage in k8s<i class="fas fa-angle-right fa-fw"></i></a></div></div>
<div id="comments"><div id="giscus"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app/">giscus</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://qingwave.github.io" target="_blank" rel="noopener noreferrer">Qingwave</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="回到顶部">
            <i class="fas fa-arrow-up fa-fw"></i>
        </a>
    </div><div class="assets"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@sliphua/pjax@2.4.0/dist/pjax.min.js"></script><script type="text/javascript" src="/js/theme.min.js" defer></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'UA-134548083-1', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-134548083-1" async></script></div>

<div class="pjax-assets"><script type="text/javascript">window.config={"code":{"maxShownLines":-1},"comment":{"giscus":{"customTheme":"light","darkTheme":"dark","dataCategory":"Announcements","dataCategoryId":"DIC_kwDOCg97r84CBQfL","dataEmitMetadata":"0","dataInputPosition":"top","dataLang":"en","dataMapping":"title","dataReactionsEnabled":"1","dataRepo":"qingwave/qingwave.github.io","dataRepoId":"MDEwOlJlcG9zaXRvcnkxNjg3ODY4NjM=","lightTheme":"light"}}};</script><script type="text/javascript" src="/js/giscus.min.js" defer></script></div>
</body>

</html>