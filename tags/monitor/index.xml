<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>monitor - 标签 - Qingwave</title>
        <link>https://qingwave.github.io/tags/monitor/</link>
        <description>monitor - 标签 - Qingwave</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>isguory@gmail.com (Qingwave)</managingEditor>
            <webMaster>isguory@gmail.com (Qingwave)</webMaster><lastBuildDate>Thu, 16 Jul 2020 15:28:39 &#43;0000</lastBuildDate><atom:link href="https://qingwave.github.io/tags/monitor/" rel="self" type="application/rss+xml" /><item>
    <title>Prometheus最佳实践-聚合函数</title>
    <link>https://qingwave.github.io/prometheus-best-practice-operation/</link>
    <pubDate>Thu, 16 Jul 2020 15:28:39 &#43;0000</pubDate><author>
        <name>qinng</name>
    </author><guid>https://qingwave.github.io/prometheus-best-practice-operation/</guid>
    <description><![CDATA[<h2 id="rate" class="headerLink">
    <a href="#rate" class="header-mark"></a>rate</h2><p>prometheus中<code>rate</code>只能用于<code>counter</code>类型，对于需要聚合的数据需要先<code>rate</code>再<code>sum</code>，而不是<code>rate(sum)</code></p>
<h2 id="数据准确性" class="headerLink">
    <a href="#%e6%95%b0%e6%8d%ae%e5%87%86%e7%a1%ae%e6%80%a7" class="header-mark"></a>数据准确性</h2><p><code>rate/increase/delta</code>等操作对于原始值进行了外推（类似线性插件），得到的不是准确值</p>
<p>如<code>rate(http_requests_total[2m])</code>指两分钟内每秒平均请求量，通过<code>2m</code>内首尾两个数据外推得到差值，比120s得到；
同理<code>increase(http_requests_total[2m])</code>指的不是首尾两个值的增长量，而是外推后计算出<code>2m</code>内的增长量。</p>
<h2 id="absent" class="headerLink">
    <a href="#absent" class="header-mark"></a>absent</h2><p>通常报警中，我们需要对某个对象是不是有数据进行监控（即<code>nodata</code>监控），<code>absent</code>用来验证指标是不是有数据很有用</p>
<h2 id="predict_linear" class="headerLink">
    <a href="#predict_linear" class="header-mark"></a>predict_linear</h2><p>线性回归预测，适合线性数据的预测，如预测etcd的未来4小时文件描述符使用量</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">predict_linear(cluster:etcd:fd_utilization[1h], 3600 * 4)
</span></span></code></pre></div><h2 id="quantile_over_time" class="headerLink">
    <a href="#quantile_over_time" class="header-mark"></a>quantile_over_time</h2><p>一段时间内统计分位数</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">quantile_over_time(0.9, http_requests_total[1d]) # 一天内请求量的90分位
</span></span></code></pre></div><h2 id="bool" class="headerLink">
    <a href="#bool" class="header-mark"></a>bool</h2><p>某些情况的需要比较两个标量（通常用来报警），可以使用bool</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http_requests_total &gt; bool 100 
</span></span></code></pre></div>]]></description>
</item></channel>
</rss>
